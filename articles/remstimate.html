<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="remstimate">
<title>Modeling relational event networks with remstimate • remstimate</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modeling relational event networks with remstimate">
<meta property="og:description" content="remstimate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">remstimate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.10</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-other-packages">Other Packages</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-other-packages">
    <a class="external-link dropdown-item" href="https://github.com/TilburgNetworkGroup/remify">remify</a>
    <a class="external-link dropdown-item" href="https://tilburgnetworkgroup.github.io/remstats/">remstats</a>
    <a class="external-link dropdown-item" href="https://github.com/TilburgNetworkGroup/remulate">remulate</a>
    <a class="external-link dropdown-item" href="https://github.com/TilburgNetworkGroup/bremory">bremory</a>
    <a class="external-link dropdown-item" href="https://github.com/TilburgNetworkGroup/remx">remx</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TilburgNetworkGroup/remverse">remverse</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/TiUNetworkGroup">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TilburgNetworkGroup/remstimate">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Modeling relational event networks with remstimate</h1>
            <h3 data-toc-skip class="subtitle"><i>A tutorial</i></h3>
                        <h4 data-toc-skip class="author"></h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/TilburgNetworkGroup/remstimate/blob/HEAD/vignettes/remstimate.Rmd" class="external-link"><code>vignettes/remstimate.Rmd</code></a></small>
      <div class="d-none name"><code>remstimate.Rmd</code></div>
    </div>

    
    
<p>The aim of the function <code><a href="../reference/remstimate.html">remstimate()</a></code> is to find the set
of model parameters that optimizes either: (1) the likelihood function
given the observed data or (2) the posterior probability of the
parameters given the prior information on their distribution and the
likelihood of the data. Furthermore, the likelihood function may differ
depending on the modeling framework used, be it tie-oriented or
actor-oriented:</p>
<ul>
<li><p>the <b>tie-oriented</b> framework, which models the occurrence of
dyadic events as realization of ties along with their waiting time <span class="citation">(<a href="#ref-Butts2008">Butts
2008</a>)</span>;</p></li>
<li>
<p>the <b>actor-oriented</b> framework, which models the occurrence
of the dyadic events as a two-steps process <span class="citation">(<a href="#ref-Stadtfeld2017">Stadtfeld and Block 2017</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li>in the first step, it models the propensity of any actor to initiate
any form of interaction as a sender and the waiting time to the next
interaction (sender rate model);</li>
<li>in the second step, it models the probability of the sender at 1.
choosing the receiver of its future interaction (receiver choice
model).</li>
</ol>
</li>
</ul>
<p>The mandatory input arguments of <code><a href="../reference/remstimate.html">remstimate()</a></code> are:</p>
<ul>
<li><p><code>reh</code>, which is a <code>remify</code> object of the
processed relational event history (processing function
<code>remify</code> available with the package <code>remify</code>,
<code>install.packages("remify")</code>);</p></li>
<li><p><code>stats</code>, a <code>remstats</code> object (the
<code>remstats</code> function for calculating network statistics is
available with the package <code>remstats</code>,
<code>install.packages("remstats")</code>). A linear predictor for the
model is specified via a formula object (for the actor-oriented
framework, up to two linear predictors can be specified) and supplied to
the function <code><a href="https://rdrr.io/pkg/remstats/man/remstats.html" class="external-link">remstats::remstats()</a></code> along with the
<code>remify</code> object. When <code>attr(reh,"model")</code> is
<code>"tie"</code>, <code>stats</code> consists of only one array of
statistics; if <code>attr(reh,"model")</code> is <code>"actor"</code>,
<code>stats</code> consists of a list that can contain up to two arrays
named <code>"sender_stats"</code> and <code>"receiver_stats"</code>. The
first array contains the statistics for the sender model (event rate
model), the second array for the receiver model (multinomial choice
model). Furthermore, it is possible to calculate the statistics for only
the sender model or only the receiver model, by supplying the formula
object only for one of the two models. For more details on the use of
<code><a href="https://rdrr.io/pkg/remstats/man/remstats.html" class="external-link">remstats::remstats()</a></code>, see
<code><a href="https://rdrr.io/pkg/remstats/man/remstats.html" class="external-link">help(topic=remstats,package=remstats)</a></code>.</p></li>
</ul>
<p>Along with the two mandatory arguments, the argument
<code>method</code> refers to the optimization routine to use for the
estimation of the model parameters and its default value is
<code>"MLE"</code>. Methods available in <code>remstimate</code> are:
<strong>Maximum Likelihood Estimation</strong> (<code>"MLE"</code>),
<strong>Adaptive Gradient Descent</strong> (<code>"GDADAMAX"</code>),
<strong>Bayesian Sampling Importance Resampling</strong>
(<code>"BSIR"</code>), <strong>Hamiltonian Monte Carlo</strong>
(<code>"HMC"</code>).</p>
<hr>
<div class="section level5">
<h5 id="estimation-approaches-frequentist-and-bayesian">Estimation approaches: Frequentist and Bayesian<a class="anchor" aria-label="anchor" href="#estimation-approaches-frequentist-and-bayesian"></a>
</h5>
<p>In order to optimize model parameters, the available approaches
resort to either the Frequentist theory or the Bayesian theory. The
<code>remstimate</code> package provides several optimization methods to
estimate the model parameters:</p>
<ul>
<li>two Frequentist approaches such as Maximum Likelihood Estimation
(<code>"MLE"</code>) and Adaptive Gradient Descent
(<code>"GDADAMAX"</code>) which are respectively second-order and
first-order optimization algorithms;</li>
<li>two Bayesian approaches such as Bayesian Sampling Importance
Resampling (<code>"BSIR"</code>) and Hamiltonian Monte Carlo
(<code>"HMC"</code>).</li>
</ul>
<p>To provide a concise overview of the two approaches, consider a
time-ordered sequence of <span class="math inline">\(M\)</span>
relational events, <span class="math inline">\(E_{t_M}=(e_1,\ldots,e_M)\)</span>, the array of
statistics (explanatory variables) <span class="math inline">\(X\)</span>, and <span class="math inline">\(\boldsymbol{\beta}\)</span> the vector of model
parameters describing the effect of the explanatory variables, which we
want to estimate. The explanation that follows below is valid for both
tie-oriented and actor-oriented modeling frameworks.</p>
<p>The aim of the <em>Frequentist</em> approaches is to find the set of
parameters <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span>
that maximizes the value of the likelihood function <span class="math inline">\(\mathscr{L}(\boldsymbol{\beta};
E_{t_M},X)\)</span>, that is</p>
<p><span class="math display">\[
    \boldsymbol{\hat{\beta}}=\mathop{\mathrm{arg\,max}}_{\boldsymbol{\beta}}\{\mathscr{L}(\boldsymbol{\beta};E_{t_M},X)\}
\]</span></p>
<p>Whereas, the aim of the <em>Bayesian</em> approaches is to find the
set of parameters <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span> that maximizes
the posterior probability of the model which is proportional to the
likelihood of the observed data and the prior distribution assumed over
the model parameters,</p>
<p><span class="math display">\[p(\boldsymbol{\beta}|E_{t_M},X) \propto
\mathscr{L}(\boldsymbol{\beta}; E_{t_M},X)
p(\boldsymbol{\beta})\]</span></p>
<p>where <span class="math inline">\(p(\boldsymbol{\beta})\)</span> is
the prior distribution of the model parameters which, for instance, can
be assumed as a multivariate normal distribution,</p>
<p><span class="math display">\[ \boldsymbol{\beta} \sim
\mathcal{N}(\boldsymbol{\mu_{0}},\Sigma_{0}) \]</span></p>
<p>with parameters <span class="math inline">\((\boldsymbol{\mu_{0}},\Sigma_{0})\)</span>
summarizing the prior information that the researcher may have on the
distributon of <span class="math inline">\(\boldsymbol{\beta}\)</span>.</p>
<hr>
</div>
<div class="section level5">
<h5 id="lets-get-started-loading-the-remstimate-package">Let’s get started (loading the <code>remstimate</code> package)<a class="anchor" aria-label="anchor" href="#lets-get-started-loading-the-remstimate-package"></a>
</h5>
<p>Before starting, we want to first load the <code>remstimate</code>
package. This will laod in turn <code>remify</code> and
<code>remstats</code>, which we need respectively for processing the
relational event history and for calculating/processing the statistics
specified in the model:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TilburgNetworkGroup/remstimate" class="external-link">remstimate</a></span><span class="op">)</span></span></code></pre></div>
<p>In this tutorial, we are going to use the main functions from
<code>remify</code> and <code>remstats</code> by setting their arguments
to the default values. However, we suggest the user to read through the
documentation of the two packages and their vignettes in order to get
familiar with their additional functionalities (e.g., possibility of
defining time-varying risk set, calculating statistics for a specific
time window, and many others).</p>
<hr>
</div>
<div class="section level2">
<h2 id="modeling-frameworks">Modeling frameworks<a class="anchor" aria-label="anchor" href="#modeling-frameworks"></a>
</h2>
<div class="section level3">
<h3 id="tie-oriented-modeling-framework">Tie-Oriented Modeling framework<a class="anchor" aria-label="anchor" href="#tie-oriented-modeling-framework"></a>
</h3>
<p>For the tie-oriented modeling, we refer to the seminal paper by <span class="citation">Butts (<a href="#ref-Butts2008">2008</a>)</span>, in
which the author introduces the likelihood function of a relational
event model (REM). Relational events are modeled in a tie-oriented
approach along with their waiting time (if measured). When the time
variable is not available, then the model reduces to the Cox
proportional-hazard survival model <span class="citation">(<a href="#ref-Cox1972">Cox 1972</a>)</span>.</p>
<hr>
<div class="section level4">
<h4 id="the-likelihood-function">The likelihood function<a class="anchor" aria-label="anchor" href="#the-likelihood-function"></a>
</h4>
<p>Consider a time-ordered sequence of <span class="math inline">\(M\)</span> relational events, <span class="math inline">\(E_{t_M}=(e_1,\ldots,e_M)\)</span>, where each
event <span class="math inline">\(e_{m}\)</span> in the sequence is
described by the 4-tuple <span class="math inline">\((s_{m},r_{m},c_{m},t_{m})\)</span>, respectively
sender, receiver, type and time of the event. Furthermore,</p>
<ul>
<li>
<span class="math inline">\(N\)</span> is the number of actors in
the network. For simplicity, we assume here that all actors in the
network can be the sender or the receiver of a relational event;</li>
<li>
<span class="math inline">\(C\)</span> is the number of event types,
which may describe the sentiment of an interaction (e.g., a praise to a
colleague, or a conflict between countries). We set <span class="math inline">\(C=1\)</span> for simplicity, which also means that
we work with events without sentiment (at least not available in the
data);</li>
<li>
<span class="math inline">\(P\)</span> is the number of sufficient
statistics (explanatory variables);</li>
</ul>
<p>The likelihood function that models a relational event sequence with
a tie-oriented approach is, <span class="math display">\[
\mathscr{L}(\boldsymbol{\beta}; E_{t_M},X)=
\prod_{m=1}^{M}{\Bigg[\lambda(e_{m},t_{m},\boldsymbol{\beta})\prod_{e\in
\mathcal{R}}^{}{\exp{\left\lbrace-\lambda(e,t_{m},\boldsymbol{\beta})\left(t_m-t_{m-1}\right)\right\rbrace}
}}\Bigg]
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(\lambda(e,t_{m},\boldsymbol{\beta})\)</span> is
the rate of occurrence of the event <span class="math inline">\(e\)</span> at time <span class="math inline">\(t_{m}\)</span>. The event rate describes the
istantaneous probability of occurrence of an event at a specific time
point and it is modeled as <span class="math inline">\(\lambda(e,t_{m},\boldsymbol{\beta}) =
\exp{\left\lbrace
\boldsymbol{\beta}^{T}X_{[m,e,.]}\right\rbrace}\)</span> where:
<ul>
<li>
<span class="math inline">\(\boldsymbol{\beta}\)</span> is the
vector of parameters of interest. Such parameters describe the effect
that the sufficient statistics (explanatory variables) have on the event
rate;</li>
<li>
<span class="math inline">\(\boldsymbol{\beta}^{T}X_{[m,e,.]} =
\sum_{p=1}^{P}{\beta_p X_{[m,e,p]}}\)</span> is the linear predictor of
the event <span class="math inline">\(e\)</span> at time <span class="math inline">\(t_{m}\)</span>. The object <span class="math inline">\(X\)</span> is a three dimensional array with
number of rows equal to the number of unique time points (or events) in
the sequence (see <code>vignette(package="remstats")</code> for more
information about statistics calculated <em>per unique time point</em>
or <em>per observed event</em>), number of columns equal to number of
dyadic events (<span class="math inline">\(D\)</span>), (see
<code><a href="https://cran.rstudio.com/web/packages/remify/vignettes/remify.html" class="external-link">vignette(topic="remify",package="remify")</a></code> for more
information on how to quantify the number of dyadic events), number of
slices equal to the number of variables in the linear predictor (<span class="math inline">\(P\)</span>).</li>
</ul>
</li>
<li>
<span class="math inline">\(e_m\)</span> refers to the event
occurred at time <span class="math inline">\(t_m\)</span> and <span class="math inline">\(e\)</span> refers to any event at risk at time
<span class="math inline">\(t_m\)</span>;</li>
<li>
<span class="math inline">\(\mathcal{R}\)</span> describes the set
of events at risk at each time point (including also the occurring
event). In this case, the risk set is assumed to be the <em>full</em>
risk set (see <code><a href="https://cran.rstudio.com/web/packages/remify/vignettes/riskset.html" class="external-link">vignette(topic="riskset",package="remify")</a></code>
for more information on alternative definitions of the risk set), which
means that all the possible dyadic events are at risk at any time
point;</li>
<li>
<span class="math inline">\((t_{m}-t_{m-1})\)</span> is the waiting
time between two subsequent events.</li>
</ul>
<p>If the time of occurrence of the events is not available and we know
only their order of occurrence, then the likelihood function reduces to
the Cox proportional-hazard survival model <span class="citation">(<a href="#ref-Cox1972">Cox 1972</a>)</span>,</p>
<p><span class="math display">\[ \mathscr{L}(\boldsymbol{\beta};
E_{t_M},X)=
\prod_{m=1}^{M}{\Bigg[\frac{\lambda(e_{m},t_{m},\boldsymbol{\beta})}{\sum_{e\in
\mathcal{R}}^{}{\lambda(e,t_{m},\boldsymbol{\beta})}}}\Bigg]
\]</span></p>
<hr>
<div class="section level5">
<h5 id="a-toy-example-on-the-tie-oriented-modeling-framework">A toy example on the tie oriented modeling framework<a class="anchor" aria-label="anchor" href="#a-toy-example-on-the-tie-oriented-modeling-framework"></a>
</h5>
<p>In order to get started with the optimization methods available in
<code>remstimate</code>, we consider the data <code>tie_data</code>,
that is a list containing a simulated relational event sequence where
events were generated by following a tie-oriented process. We are going
to model the event rate <span class="math inline">\(\lambda\)</span> of
any event event <span class="math inline">\(e\)</span> at risk at time
<span class="math inline">\(t_{m}\)</span> as:</p>
<p><span class="math display">\[\begin{align}\lambda(e,t_{m},\boldsymbol{\beta})
= \exp{\left\lbrace\beta_{intercept} +
\beta_{\text{indegreeSender}}\text{indegreeSender}(s_e,t_{m}) + \\
+\beta_{\text{inertia}}\text{inertia}(s_e,r_e,t_{m}) +
\beta_{\text{reciprocity}}\text{reciprocity}(s_e,r_e,t_{m})\right\rbrace}\end{align}\]</span></p>
<p>Furthermore, we know that the <em>true</em> parameters quantifying
the effect of the <em>statistics</em> (name in subscript next to <span class="math inline">\(\beta\)</span>) and used in the generation of the
event sequence are: <span class="math display">\[\begin{bmatrix}
\beta_{intercept} \\ \beta_{\text{indegreeSender}} \\
\beta_{\text{inertia}} \\ \beta_{\text{reciprocity}} \end{bmatrix} =
\begin{bmatrix} -5.0 \\ 0.01 \\ -0.1 \\ 0.03\end{bmatrix}\]</span> The
parameters are also available as object within the list,
<code>tie_data$true.pars</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># setting `ncores` to 1 (the user can change this parameter)</span></span>
<span><span class="va">ncores</span> <span class="op">&lt;-</span> <span class="fl">1L</span></span>
<span></span>
<span><span class="co"># loading data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tie_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># true parameters' values</span></span>
<span><span class="va">tie_data</span><span class="op">$</span><span class="va">true.pars</span></span></code></pre></div>
<pre><code><span><span class="co">##      intercept indegreeSender        inertia    reciprocity </span></span>
<span><span class="co">##          -5.00           0.01          -0.10           0.03</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># processing the event sequence with 'remify'</span></span>
<span><span class="va">tie_reh</span> <span class="op">&lt;-</span> <span class="fu">remify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/remify/man/remify.html" class="external-link">remify</a></span><span class="op">(</span>edgelist <span class="op">=</span> <span class="va">tie_data</span><span class="op">$</span><span class="va">edgelist</span>, model <span class="op">=</span> <span class="st">"tie"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summary of the (processed) relational event network</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tie_reh</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Network</span></span>
<span><span class="co">## (processed for tie-oriented modeling):</span></span>
<span><span class="co">##  &gt; events = 100</span></span>
<span><span class="co">##  &gt; actors = 5</span></span>
<span><span class="co">##  &gt; riskset = full</span></span>
<span><span class="co">##  &gt; directed = TRUE</span></span>
<span><span class="co">##  &gt; ordinal = FALSE</span></span>
<span><span class="co">##  &gt; weighted = FALSE</span></span>
<span><span class="co">##  &gt; time length ~ 807 </span></span>
<span><span class="co">##  &gt; interevent time </span></span>
<span><span class="co">##       &gt;&gt; minimum ~ 0.1832 </span></span>
<span><span class="co">##       &gt;&gt; maximum ~ 63.6192</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="estimating-a-model-with-remstimate-in-3-steps">Estimating a model with <code>remstimate()</code> in 3 steps<a class="anchor" aria-label="anchor" href="#estimating-a-model-with-remstimate-in-3-steps"></a>
</h5>
<p>The estimation of a model can be summarized in three steps:</p>
<ol style="list-style-type: decimal">
<li>First, we define the linear predictor with the variables of
interest, using the statistics available within <code>remstats</code>
(statistics calculated by the user can be also supplied to
<code><a href="https://rdrr.io/pkg/remstats/man/remstats.html" class="external-link">remstats::remstats()</a></code>).</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># specifying linear predictor (with `remstats`) using a 'formula'</span></span>
<span><span class="va">tie_model</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu">remstats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/remstats/man/indegreeSender.html" class="external-link">indegreeSender</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>              <span class="fu">remstats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/remstats/man/inertia.html" class="external-link">inertia</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">remstats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/remstats/man/reciprocity.html" class="external-link">reciprocity</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Second, we calculate the statistics defined in the linear predictor
with the function <code><a href="https://rdrr.io/pkg/remstats/man/remstats.html" class="external-link">remstats::remstats()</a></code> from the
<code>remstats</code> package.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculating statistics (with `remstats`)</span></span>
<span><span class="va">tie_stats</span> <span class="op">&lt;-</span> <span class="fu">remstats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/remstats/man/remstats.html" class="external-link">remstats</a></span><span class="op">(</span>reh <span class="op">=</span> <span class="va">tie_reh</span>, tie_effects <span class="op">=</span> <span class="va">tie_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the 'tomstats' 'remstats' object</span></span>
<span><span class="va">tie_stats</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Network Statistics</span></span>
<span><span class="co">## &gt; Model: tie-oriented</span></span>
<span><span class="co">## &gt; Computation method: per time point</span></span>
<span><span class="co">## &gt; Dimensions: 100 time points x 20 dyads x 4 statistics</span></span>
<span><span class="co">## &gt; Statistics:</span></span>
<span><span class="co">##   &gt;&gt; 1: baseline</span></span>
<span><span class="co">##   &gt;&gt; 2: indegreeSender</span></span>
<span><span class="co">##   &gt;&gt; 3: inertia</span></span>
<span><span class="co">##   &gt;&gt; 4: reciprocity</span></span></code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Finally, we are ready to run any of the optimization methods with
the function <code><a href="../reference/remstimate.html">remstimate::remstimate()</a></code>.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for example the method "MLE"</span></span>
<span><span class="fu">remstimate</span><span class="fu">::</span><span class="fu"><a href="../reference/remstimate.html">remstimate</a></span><span class="op">(</span>reh <span class="op">=</span> <span class="va">tie_reh</span>,</span>
<span>                          stats <span class="op">=</span>  <span class="va">tie_stats</span>,</span>
<span>                          method <span class="op">=</span> <span class="st">"MLE"</span>,</span>
<span>                          ncores <span class="op">=</span> <span class="va">ncores</span><span class="op">)</span>    </span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Model (tie oriented) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       baseline indegreeSender        inertia    reciprocity </span></span>
<span><span class="co">##    -4.91045403     0.04349023    -0.20150573    -0.05213701 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Null deviance: 1216.739 </span></span>
<span><span class="co">## Residual deviance: 1210.625 </span></span>
<span><span class="co">## AIC: 1218.625 AICC: 1219.046 BIC: 1229.045</span></span></code></pre>
<p>In the sections below, we show the estimation of the parameters using
all the methods available and we also show the usage and output of the
methods available for a <code>remstimate</code> object.</p>
<hr>
</div>
</div>
<div class="section level4">
<h4 id="frequentist-approaches">
<em>Frequentist</em> approaches<a class="anchor" aria-label="anchor" href="#frequentist-approaches"></a>
</h4>
<div class="section level5">
<h5 id="maximum-likelihood-estimation-mle">
<strong>Maximum Likelihood Estimation (MLE)</strong><a class="anchor" aria-label="anchor" href="#maximum-likelihood-estimation-mle"></a>
</h5>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">tie_mle</span> <span class="op">&lt;-</span> <span class="fu">remstimate</span><span class="fu">::</span><span class="fu"><a href="../reference/remstimate.html">remstimate</a></span><span class="op">(</span>reh <span class="op">=</span> <span class="va">tie_reh</span>,</span>
<span>                          stats <span class="op">=</span> <span class="va">tie_stats</span>,</span>
<span>                          ncores <span class="op">=</span> <span class="va">ncores</span>,</span>
<span>                          method <span class="op">=</span> <span class="st">"MLE"</span>,</span>
<span>                          WAIC <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># setting WAIC computation to TRUE</span></span>
<span>                          nsimWAIC <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># number of draws for the computation of the WAIC set to 100         </span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="print">
<strong>print( )</strong><a class="anchor" aria-label="anchor" href="#print"></a>
</h5>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># printing the 'remstimate' object</span></span>
<span><span class="va">tie_mle</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Model (tie oriented) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       baseline indegreeSender        inertia    reciprocity </span></span>
<span><span class="co">##    -4.91045403     0.04349023    -0.20150573    -0.05213701 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Null deviance: 1216.739 </span></span>
<span><span class="co">## Residual deviance: 1210.625 </span></span>
<span><span class="co">## AIC: 1218.625 AICC: 1219.046 BIC: 1229.045 WAIC: 1219.669</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="summary">
<strong>summary( )</strong><a class="anchor" aria-label="anchor" href="#summary"></a>
</h5>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># summary of the 'remstimate' object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tie_mle</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Model (tie oriented) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## ~1 + remstats::indegreeSender() + remstats::inertia() + remstats::reciprocity()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients (MLE with interval likelihood):</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                  Estimate   Std. Err    z value Pr(&gt;|z|) Pr(=0)</span></span>
<span><span class="co">## baseline        -4.910454   0.187555 -26.181372   0.0000 &lt;2e-16</span></span>
<span><span class="co">## indegreeSender   0.043490   0.036449   1.193170   0.2328 0.8307</span></span>
<span><span class="co">## inertia         -0.201506   0.088154  -2.285831   0.0223 0.4231</span></span>
<span><span class="co">## reciprocity     -0.052137   0.098237  -0.530728   0.5956 0.8968</span></span>
<span><span class="co">## Null deviance: 1216.739 on 100 degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 1210.625 on 96 degrees of freedom</span></span>
<span><span class="co">## Chi-square: 6.11449 on 4 degrees of freedom, asymptotic p-value 0.1907597 </span></span>
<span><span class="co">## AIC: 1218.625 AICC: 1219.046 BIC: 1229.045 WAIC: 1219.669</span></span></code></pre>
<p>Under the column named <span class="math inline">\(Pr(&gt;|z|)\)</span>, the usual test on the
<code>z value</code> for each parameter. As to the column named <span class="math inline">\(Pr(=0|x)\)</span>, an approximation of the
posterior probability of each parameter being equal to 0.</p>
</div>
<div class="section level5">
<h5 id="information-critieria">
<strong>Information Critieria</strong><a class="anchor" aria-label="anchor" href="#information-critieria"></a>
</h5>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># aic</span></span>
<span><span class="fu"><a href="../reference/aic.html">aic</a></span><span class="op">(</span><span class="va">tie_mle</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1218.625</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># aicc</span></span>
<span><span class="fu"><a href="../reference/aicc.html">aicc</a></span><span class="op">(</span><span class="va">tie_mle</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1219.046</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># bic </span></span>
<span><span class="fu"><a href="../reference/bic.html">bic</a></span><span class="op">(</span><span class="va">tie_mle</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1229.045</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#waic </span></span>
<span><span class="fu"><a href="../reference/waic.html">waic</a></span><span class="op">(</span><span class="va">tie_mle</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1219.669</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="diagnostics">
<strong>diagnostics( )</strong><a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h5>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># diagnostics</span></span>
<span><span class="va">tie_mle_diagnostics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diagnostics.html">diagnostics</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">tie_mle</span>, reh <span class="op">=</span> <span class="va">tie_reh</span>, stats <span class="op">=</span> <span class="va">tie_stats</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="plot">
<strong>plot( )</strong><a class="anchor" aria-label="anchor" href="#plot"></a>
</h5>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tie_mle</span>, reh  <span class="op">=</span> <span class="va">tie_reh</span>, diagnostics <span class="op">=</span> <span class="va">tie_mle_diagnostics</span><span class="op">)</span></span></code></pre></div>
<p><img src="remstimate_files/figure-html/unnamed-chunk-11-1.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-11-2.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-11-3.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-11-4.png" width="50%"></p>
<hr>
</div>
<div class="section level5">
<h5 id="adaptive-gradient-descent-optimization-gdadamax">
<strong>Adaptive Gradient Descent Optimization
(GDADAMAX)</strong><a class="anchor" aria-label="anchor" href="#adaptive-gradient-descent-optimization-gdadamax"></a>
</h5>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tie_gd</span> <span class="op">&lt;-</span> <span class="fu">remstimate</span><span class="fu">::</span><span class="fu"><a href="../reference/remstimate.html">remstimate</a></span><span class="op">(</span>reh <span class="op">=</span> <span class="va">tie_reh</span>,</span>
<span>                        stats <span class="op">=</span>  <span class="va">tie_stats</span>,</span>
<span>                        ncores <span class="op">=</span> <span class="va">ncores</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"GDADAMAX"</span>,</span>
<span>                        epochs <span class="op">=</span> <span class="fl">200L</span>, <span class="co"># number of iterations for the Gradient-Descent algorithm</span></span>
<span>                        WAIC <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># setting WAIC computation to TRUE</span></span>
<span>                        nsimWAIC <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># number of draws for the computation of the WAIC set to 100     </span></span>
<span><span class="co"># print </span></span>
<span><span class="va">tie_gd</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Model (tie oriented) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       baseline indegreeSender        inertia    reciprocity </span></span>
<span><span class="co">##   -5.022630364   -0.008719889    0.027182180   -0.028030095 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Null deviance: 1216.739 </span></span>
<span><span class="co">## Residual deviance: 1217.914 </span></span>
<span><span class="co">## AIC: 1225.914 AICC: 1226.335 BIC: 1236.334 WAIC: 1225.534</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># diagnostics</span></span>
<span><span class="va">tie_gd_diagnostics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diagnostics.html">diagnostics</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">tie_gd</span>, reh <span class="op">=</span> <span class="va">tie_reh</span>, stats <span class="op">=</span> <span class="va">tie_stats</span><span class="op">)</span></span>
<span><span class="co"># plot</span></span>
<span><span class="co"># plot(x = tie_gd, reh  = tie_reh, diagnostics = tie_gd_diagnostics) # uncomment to use the plot function</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level4">
<h4 id="bayesian-approaches">
<em>Bayesian</em> approaches<a class="anchor" aria-label="anchor" href="#bayesian-approaches"></a>
</h4>
<div class="section level5">
<h5 id="bayesian-sampling-importance-resampling-bsir">
<strong>Bayesian Sampling Importance Resampling (BSIR)</strong><a class="anchor" aria-label="anchor" href="#bayesian-sampling-importance-resampling-bsir"></a>
</h5>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mfasiolo/mvnfast/" class="external-link">mvnfast</a></span><span class="op">)</span> <span class="co"># loading package for fast simulation from a multivariate Student t distribution</span></span>
<span><span class="va">priormvt</span> <span class="op">&lt;-</span> <span class="fu">mvnfast</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/mvnfast/man/dmvt.html" class="external-link">dmvt</a></span> <span class="co"># defining which distribution we want to use from the 'mvnfast' package</span></span>
<span><span class="va">tie_bsir</span> <span class="op">&lt;-</span> <span class="fu">remstimate</span><span class="fu">::</span><span class="fu"><a href="../reference/remstimate.html">remstimate</a></span><span class="op">(</span>reh <span class="op">=</span> <span class="va">tie_reh</span>,</span>
<span>                        stats <span class="op">=</span>  <span class="va">tie_stats</span>,</span>
<span>                        ncores <span class="op">=</span> <span class="va">ncores</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"BSIR"</span>,</span>
<span>                        nsim <span class="op">=</span> <span class="fl">200L</span>, <span class="co"># 200 draws from the posterior distribution</span></span>
<span>                        prior <span class="op">=</span> <span class="va">priormvt</span>, <span class="co"># defining prior here, prior parameters follow below</span></span>
<span>                        mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">tie_stats</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="co"># prior mu value</span></span>
<span>                        sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">tie_stats</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fl">1.5</span>, <span class="co"># prior sigma value</span></span>
<span>                        df <span class="op">=</span> <span class="fl">1</span>, <span class="co"># prior df value</span></span>
<span>                        log <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># requiring log density values from the prior,</span></span>
<span>                        seed <span class="op">=</span> <span class="fl">23029</span>, <span class="co"># set a seed only for reproducibility purposes</span></span>
<span>                        WAIC <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># setting WAIC computation to TRUE</span></span>
<span>                        nsimWAIC <span class="op">=</span> <span class="fl">100</span> <span class="co"># number of draws for the computation of the WAIC set to 100     </span></span>
<span>                        <span class="op">)</span></span>
<span></span>
<span><span class="co"># summary </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tie_bsir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Model (tie oriented) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## ~1 + remstats::indegreeSender() + remstats::inertia() + remstats::reciprocity()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Posterior Modes (BSIR with interval likelihood):</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                Post.Mode   Post.SD     Q2.5%      Q50%  Q97.5% Pr(=0|x)</span></span>
<span><span class="co">## baseline       -4.940502  0.186072 -5.277344 -4.886659 -4.5644   &lt;2e-16</span></span>
<span><span class="co">## indegreeSender  0.038982  0.035994 -0.031385  0.042822  0.1095   0.8476</span></span>
<span><span class="co">## inertia        -0.203187  0.094298 -0.382460 -0.203889 -0.0326   0.4953</span></span>
<span><span class="co">## reciprocity    -0.017419  0.093554 -0.234598 -0.061255  0.1357   0.9076</span></span>
<span><span class="co">## Log posterior: -615.9267 WAIC: 1219.248</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># diagnostics</span></span>
<span><span class="va">tie_bsir_diagnostics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diagnostics.html">diagnostics</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">tie_bsir</span>, reh <span class="op">=</span> <span class="va">tie_reh</span>, stats <span class="op">=</span> <span class="va">tie_stats</span><span class="op">)</span></span>
<span><span class="co"># plot</span></span>
<span><span class="co"># plot(x = tie_bsir, reh  = tie_reh, diagnostics = tie_bsir_diagnostics) # uncomment to use the plot function</span></span></code></pre></div>
<hr>
</div>
<div class="section level5">
<h5 id="hamiltonian-monte-carlo-hmc">
<strong>Hamiltonian Monte Carlo (HMC)</strong><a class="anchor" aria-label="anchor" href="#hamiltonian-monte-carlo-hmc"></a>
</h5>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tie_hmc</span> <span class="op">&lt;-</span> <span class="fu">remstimate</span><span class="fu">::</span><span class="fu"><a href="../reference/remstimate.html">remstimate</a></span><span class="op">(</span>reh <span class="op">=</span> <span class="va">tie_reh</span>,</span>
<span>                        stats <span class="op">=</span>  <span class="va">tie_stats</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"HMC"</span>,</span>
<span>                        ncores <span class="op">=</span> <span class="va">ncores</span>,</span>
<span>                        nsim <span class="op">=</span> <span class="fl">200L</span>, <span class="co"># 200 draws to generate per each chain</span></span>
<span>                        nchains <span class="op">=</span> <span class="fl">4L</span>, <span class="co"># 4 chains to generate</span></span>
<span>                        burnin <span class="op">=</span> <span class="fl">200L</span>, <span class="co"># burnin length is 200</span></span>
<span>                        thin <span class="op">=</span> <span class="fl">2L</span>, <span class="co"># thinning size set to 2 (the final length of the chains will be 100)</span></span>
<span>                        seed <span class="op">=</span> <span class="fl">23029</span>, <span class="co"># set a seed only for reproducibility purposes</span></span>
<span>                        WAIC <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># setting WAIC computation to TRUE</span></span>
<span>                        nsimWAIC <span class="op">=</span> <span class="fl">100</span> <span class="co"># number of draws for the computation of the WAIC set to 100     </span></span>
<span>                        <span class="op">)</span></span>
<span></span>
<span><span class="co"># summary </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tie_hmc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Model (tie oriented) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## ~1 + remstats::indegreeSender() + remstats::inertia() + remstats::reciprocity()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Posterior Modes (HMC with interval likelihood):</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                  Post.Mode     Post.SD       Q2.5%        Q50%  Q97.5%</span></span>
<span><span class="co">## baseline       -4.89176602  0.10098116 -5.13667338 -4.91842653 -4.7228</span></span>
<span><span class="co">## indegreeSender  0.04216992  0.02128111 -0.00011355  0.04485789  0.0848</span></span>
<span><span class="co">## inertia        -0.20584522  0.05187206 -0.29432727 -0.19865069 -0.0960</span></span>
<span><span class="co">## reciprocity    -0.05412344  0.05675886 -0.15335845 -0.05335163  0.0670</span></span>
<span><span class="co">##                 Pr(=0|x)</span></span>
<span><span class="co">## baseline       &lt; 2.2e-16</span></span>
<span><span class="co">## indegreeSender  0.584017</span></span>
<span><span class="co">## inertia         0.003791</span></span>
<span><span class="co">## reciprocity     0.863885</span></span>
<span><span class="co">## Log posterior: -605.3317 WAIC: 1213.59</span></span></code></pre>
<p><code>Q2.5%</code>, <code>Q50%</code> and <code>Q97.5%</code> are
respectively the percentile 2.5, the median (50th percentile) and the
percentile 97.5.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># diagnostics</span></span>
<span><span class="va">tie_hmc_diagnostics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diagnostics.html">diagnostics</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">tie_hmc</span>, reh <span class="op">=</span> <span class="va">tie_reh</span>, stats <span class="op">=</span> <span class="va">tie_stats</span><span class="op">)</span></span>
<span><span class="co"># plot (histograms and trace plot have highest posterior density intervals dashed lines in blue and posterior estimate in red)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tie_hmc</span>, reh  <span class="op">=</span> <span class="va">tie_reh</span>, diagnostics <span class="op">=</span> <span class="va">tie_hmc_diagnostics</span><span class="op">)</span></span></code></pre></div>
<p><img src="remstimate_files/figure-html/unnamed-chunk-17-1.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-17-2.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-17-3.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-17-4.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-17-5.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-17-6.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-17-7.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-17-8.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-17-9.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-17-10.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-17-11.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-17-12.png" width="50%"></p>
<hr>
</div>
</div>
</div>
<div class="section level3">
<h3 id="actor-oriented-modeling-framework">Actor-Oriented Modeling framework<a class="anchor" aria-label="anchor" href="#actor-oriented-modeling-framework"></a>
</h3>
<p>For the actor-oriented modeling, we refer the modeling framework
introduced by <span class="citation">Stadtfeld and Block (<a href="#ref-Stadtfeld2017">2017</a>)</span>, in which the process of
realization of a relational event is described by two steps:</p>
<ol style="list-style-type: decimal">
<li>first the actor that is going to initiate the next interaction and
becomes the “sender” of the future event;</li>
<li>then the choice of the “receiver” of the future event operated by
the active “sender” in step 1.</li>
</ol>
<p>The first step is modelled via a rate model (similar to a REM), in
which the waiting times are modelled along with the sequence of the
senders of the observed relational events. The second step is modelled
via a multinomial discrete choice model, where we model the choice of
the receiver of the next event conditional to the active sender at the
first step.</p>
<p>Therefore, the two models can be described by two separate likelihood
functions with their own set of parameters. The parameters in each model
will describe the effect that explanatory variables (network dynamics
and other available exogenous statistics) have on the two distinct
processes. The estimation of the model parameters for each model can be
carried out separately and for this reason, the user can also provide a
<code>remstats</code> object containing the statistics of either both or
one of the two models.</p>
<hr>
<div class="section level4">
<h4 id="the-likelihood-function-1">The likelihood function<a class="anchor" aria-label="anchor" href="#the-likelihood-function-1"></a>
</h4>
<p>Consider a time-ordered sequence of <span class="math inline">\(M\)</span> relational events, <span class="math inline">\(E_{t_M}=(e_1,\ldots,e_M)\)</span>, where each
event <span class="math inline">\(e_{m}\)</span> in the sequence is
described by the 3-tuple <span class="math inline">\((s_{m},r_{m},t_{m})\)</span> (we exclude here the
information about the event type), respectively sender, receiver, and
time of the event. Furthermore, consider <span class="math inline">\(N\)</span> to be the number of actors in the
network. For simplicity, we assume that all actors in the network can be
the sender or the receiver of a relational event (i.e. <em>full</em>
risk set, see <code><a href="https://cran.rstudio.com/web/packages/remify/vignettes/riskset.html" class="external-link">vignette(topic="riskset",package="remify")</a></code>
for more information on alternative definitions of the risk set) and we
use the index <span class="math inline">\(n\)</span> to indicate any
actor in the set <span class="math inline">\(\mathcal{R}\)</span> of
actors at risk, thus <span class="math inline">\(n \in \left\lbrace
1,2,\ldots,N\right\rbrace\)</span>.</p>
<hr>
<div class="section level5">
<h5 id="sender-activity-rate-model">Sender activity rate model<a class="anchor" aria-label="anchor" href="#sender-activity-rate-model"></a>
</h5>
<p>The likelihood function that models the sender activity is:</p>
<p><span class="math display">\[ \mathscr{L}_{\text{sender
model}}(\boldsymbol{\theta}; E_{t_M},X)=
\prod_{m=1}^{M}{\Bigg[\tau(s_{m},t_{m},\boldsymbol{\theta})\prod_{n \in
\mathcal{R}}^{}{\exp{\left\lbrace-\tau(n,t_{m},\boldsymbol{\theta})\left(t_m-t_{m-1}\right)\right\rbrace}
}}\Bigg]
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(\tau(n,t_{m},\boldsymbol{\theta})\)</span> is the
activity rate of sender <span class="math inline">\(n\)</span> at time
<span class="math inline">\(t_{m}\)</span>. The sender activity rate
describes the istantaneous probability that a sender initiates an
interaction at a specific time point and it is modeled as <span class="math inline">\(\tau(n,t_{m},\boldsymbol{\theta}) =
\exp{\left\lbrace
\boldsymbol{\theta}^{T}X_{[m,n,.]}\right\rbrace}\)</span> where:
<ul>
<li>
<span class="math inline">\(\boldsymbol{\theta}\)</span> is the
vector of parameters of interest. Such parameters describe the effect
that the sufficient statistics (explanatory variables) have on the
activity rate of the sender;</li>
<li>
<span class="math inline">\(\boldsymbol{\theta}^{T}X_{[m,n,.]} =
\sum_{p=1}^{P}{\theta_p X_{[m,n,p]}}\)</span> is the linear predictor of
the sender <span class="math inline">\(n\)</span> at time <span class="math inline">\(t_{m}\)</span>. The object <span class="math inline">\(X\)</span> is a three dimensional array with
number of rows equal to the number of unique time points (or events) in
the sequence (see <code>vignette(package="remstats")</code> for more
information about statistics calculated <em>per unique time point</em>
or <em>per observed event</em>), number of columns equal to number of
actors in the sequence (<span class="math inline">\(N\)</span>), number
of slices equal to the number of variables in the linear predictor
(<span class="math inline">\(P\)</span>).</li>
</ul>
</li>
<li>
<span class="math inline">\(s_m\)</span> refers to the sender of the
event observed at time <span class="math inline">\(t_m\)</span> and
<span class="math inline">\(n\)</span> refers to any actor that can be
sender of an interaction at time <span class="math inline">\(t_m\)</span>;</li>
<li>
<span class="math inline">\(\mathcal{R}\)</span> describes the set
of actors at risk of initiating an interaction, becoming then the future
sender of a relational event (the set also includes the actor that is
sender of the event at time <span class="math inline">\(t_m\)</span>).
In this tutorial, the risk set of the sender model is assumed to be the
<em>full</em> risk set, where all the actors in the network can be “the
sender” of a relational event at any time point in the event
sequence;</li>
<li>
<span class="math inline">\((t_{m}-t_{m-1})\)</span> is the waiting
time between two subsequent relational events.</li>
</ul>
<p>If the time of occurrence of the events is not available and we know
only their order of occurrence, then the likelihood function for the
sender model reduces to the Cox proportional-hazard survival model <span class="citation">(<a href="#ref-Cox1972">Cox 1972</a>)</span>,</p>
<p><span class="math display">\[ \mathscr{L}_{\text{sender
model}}(\boldsymbol{\theta}; E_{t_M},X)=
\prod_{m=1}^{M}{\Bigg[\frac{\tau(s_{m},t_{m},\boldsymbol{\theta})}{\sum_{n\in
\mathcal{R}}^{}{\tau(n,t_{m},\boldsymbol{\theta})}}}\Bigg]
\]</span></p>
<hr>
</div>
<div class="section level5">
<h5 id="receiver-choice-model">Receiver choice model<a class="anchor" aria-label="anchor" href="#receiver-choice-model"></a>
</h5>
<p>The likelihood function that models the receiver choice is:</p>
<p><span class="math display">\[ \mathscr{L}_{\text{receiver
model}}(\boldsymbol{\beta};
E_{t_M},X)=\prod_{m=1}^{M}{\Bigg[\frac{\exp{\left\lbrace\boldsymbol{\beta}^{T}U_{[m,r_m,.]}\right\rbrace}}{\sum_{n
\in \mathcal{R} \setminus \left\lbrace s_m \right\rbrace
}^{}{\exp{\left\lbrace\boldsymbol{\beta}^{T}U_{[m,n,.]}\right\rbrace}}}\Bigg]}
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(\exp{\left\lbrace\boldsymbol{\beta}^{T}U_{[m,r_m,.]}\right\rbrace}
\backslash \sum_{n \in \mathcal{R} \setminus \left\lbrace s_m
\right\rbrace
}^{}{\exp{\left\lbrace\boldsymbol{\beta}^{T}U_{[m,n,.]}\right\rbrace}}\)</span>
is the conditional probability that the sender <span class="math inline">\(s_m\)</span> active at time <span class="math inline">\(t_m\)</span> chooses <span class="math inline">\(r_m\)</span> as the receiver of the next
interaction, and:
<ul>
<li>
<span class="math inline">\(\boldsymbol{\beta}\)</span> is the
vector of <span class="math inline">\(K\)</span> parameters of interest.
Such parameters describe the effect that the sufficient statistics
(explanatory variables) have on the choice of a receiver;</li>
<li>
<span class="math inline">\(\boldsymbol{\beta}^{T}U_{[m,n,.]} =
\sum_{k=1}^{K}{\beta_k U_{[m,n,k]}}\)</span> is the linear predictor of
the event at time <span class="math inline">\(t_{m}\)</span> in which
the sender is <span class="math inline">\(s_m\)</span> and the receiver
is any of the possible receivers, <span class="math inline">\(n\)</span>
with <span class="math inline">\(n \neq s_m\)</span>. The object <span class="math inline">\(U\)</span> is a three dimensional array with
number of rows equal to the number of events in the sequence (see
<code>vignette(package="remstats")</code> for more information about
statistics calculated <em>per unique time point</em> or <em>per observed
event</em>), number of columns equal to number of actors (<span class="math inline">\(N\)</span>), number of slices equal to the number
of variables in the linear predictor (<span class="math inline">\(K\)</span>).</li>
</ul>
</li>
<li>
<span class="math inline">\(r_m\)</span> refers to the receiver
observed at time <span class="math inline">\(t_m\)</span> and <span class="math inline">\(n\)</span> refers to any actor that can be the
receiver of the event at time <span class="math inline">\(t_m\)</span>
(excluding the sender at time <span class="math inline">\(t_m\)</span>)</li>
<li>
<span class="math inline">\(\mathcal{R}\)</span> describes the set
of actors at risk of becoming the receiver of the next interaction. In
the case of the receiver model, the risk set composition
<em>changes</em> over time because at each time point the actor that is
currently the sender cannot be also the receiver of the interaction and
is excluded from the set of potential receivers. In this tutorial, the
risk set of the reiceiver model is assumed to be the <em>full</em> risk
set where all actors (excluding the current sender at each time point)
can be “the receiver” at any time point.</li>
</ul>
<hr>
</div>
<div class="section level5">
<h5 id="a-toy-example-on-the-actor-oriented-modeling-framework">A toy example on the actor oriented modeling framework<a class="anchor" aria-label="anchor" href="#a-toy-example-on-the-actor-oriented-modeling-framework"></a>
</h5>
<p>Consider the data <code>ao_data</code>, that is a list containing a
simulated relational event sequence where events were generated by
following the two-steps process described in the section above. We are
going to model the sender activity rate and the receiver choice as:</p>
<p><span class="math display">\[ \tau(n,t_{m},\boldsymbol{\theta}) =
\exp{\left\lbrace \theta_{\text{intercept}}  +
\theta_{indegreeSender}\text{indegreeSender}(n,t_{m})\right\rbrace}
\]</span></p>
<p><span class="math display">\[ \exp{\left\lbrace
\boldsymbol{\beta}^{T}U_{[m,n,.]} \right\rbrace} = \exp{\left\lbrace
\beta_{\text{inertia}}\text{inertia}(s_m,n,t_{m})  +
\beta_{\text{reciprocity}}\text{reciprocity}(s_m,n,t_{m})\right\rbrace}\]</span></p>
<p>Furthermore, we know that <em>true</em> parameters quantifying the
effect of the <em>statistics</em> (name in subscript next to the model
parameters <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\beta\)</span>) used in the generation of the
event sequence are:</p>
<ul>
<li>for the sender model, <span class="math display">\[\begin{bmatrix}
\theta_{intercept} \\ \theta_{\text{indegreeSender}} \end{bmatrix} =
\begin{bmatrix} -5.0 \\ 0.01 \end{bmatrix}\]</span>
</li>
<li>for the receiver model <span class="math display">\[\begin{bmatrix}  \beta_{\text{inertia}} \\
\beta_{\text{reciprocity}} \end{bmatrix} = \begin{bmatrix} -0.1 \\
0.03\end{bmatrix}\]</span>
</li>
</ul>
<p>The parameters are also available as object within the list,
<code>ao_data$true.pars</code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># setting `ncores` to 1 (the user can change this parameter)</span></span>
<span><span class="va">ncores</span> <span class="op">&lt;-</span> <span class="fl">1L</span></span>
<span></span>
<span><span class="co"># loading data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ao_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># true parameters' values</span></span>
<span><span class="va">ao_data</span><span class="op">$</span><span class="va">true.pars</span></span></code></pre></div>
<pre><code><span><span class="co">## $rate_model</span></span>
<span><span class="co">##      intercept indegreeSender </span></span>
<span><span class="co">##          -5.00           0.01 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $choice_model</span></span>
<span><span class="co">##     inertia reciprocity </span></span>
<span><span class="co">##       -0.10        0.03</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># processing event sequence with 'remify'</span></span>
<span><span class="va">ao_reh</span> <span class="op">&lt;-</span> <span class="fu">remify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/remify/man/remify.html" class="external-link">remify</a></span><span class="op">(</span>edgelist <span class="op">=</span> <span class="va">ao_data</span><span class="op">$</span><span class="va">edgelist</span>, model <span class="op">=</span> <span class="st">"actor"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summary of the relational event network</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ao_reh</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Network</span></span>
<span><span class="co">## (processed for actor-oriented modeling):</span></span>
<span><span class="co">##  &gt; events = 100</span></span>
<span><span class="co">##  &gt; actors = 5</span></span>
<span><span class="co">##  &gt; riskset = full</span></span>
<span><span class="co">##  &gt; directed = TRUE</span></span>
<span><span class="co">##  &gt; ordinal = FALSE</span></span>
<span><span class="co">##  &gt; weighted = FALSE</span></span>
<span><span class="co">##  &gt; time length ~ 2654 </span></span>
<span><span class="co">##  &gt; interevent time </span></span>
<span><span class="co">##       &gt;&gt; minimum ~ 0.8542 </span></span>
<span><span class="co">##       &gt;&gt; maximum ~ 167.3494</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="estimating-a-model-with-remstimate-in-3-steps-1">Estimating a model with <code>remstimate()</code> in 3 steps<a class="anchor" aria-label="anchor" href="#estimating-a-model-with-remstimate-in-3-steps-1"></a>
</h5>
<p>The estimation of a model can be summarized in three steps:</p>
<ol style="list-style-type: decimal">
<li>First, we define the linear predictor with the variables of
interest, using the statistics available within <code>remstats</code>
(statistics calculated by the user can be also supplied to
<code><a href="https://rdrr.io/pkg/remstats/man/remstats.html" class="external-link">remstats::remstats()</a></code>).</li>
</ol>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># specifying linear predictor (for rate and choice model, with `remstats`)</span></span>
<span><span class="va">rate_model</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu">remstats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/remstats/man/indegreeSender.html" class="external-link">indegreeSender</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">choice_model</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="fu">remstats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/remstats/man/inertia.html" class="external-link">inertia</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">remstats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/remstats/man/reciprocity.html" class="external-link">reciprocity</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Second, we calculate the statistics defined in the linear predictor
with the function <code><a href="https://rdrr.io/pkg/remstats/man/remstats.html" class="external-link">remstats::remstats()</a></code> from the
<code>remstats</code> package.</li>
</ol>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculating statistics (with `remstats`)</span></span>
<span><span class="va">ao_stats</span> <span class="op">&lt;-</span> <span class="fu">remstats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/remstats/man/remstats.html" class="external-link">remstats</a></span><span class="op">(</span>reh <span class="op">=</span> <span class="va">ao_reh</span>, sender_effects <span class="op">=</span> <span class="va">rate_model</span>, receiver_effects <span class="op">=</span> <span class="va">choice_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the 'aomstats' 'remstats' object</span></span>
<span><span class="va">ao_stats</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Network Statistics</span></span>
<span><span class="co">## &gt; Model: actor-oriented</span></span>
<span><span class="co">## &gt; Computation method: per time point</span></span>
<span><span class="co">## &gt; Sender model:</span></span>
<span><span class="co">##   &gt;&gt; Dimensions: 100 time points x 5 actors x 2 statistics</span></span>
<span><span class="co">##   &gt;&gt; Statistics:</span></span>
<span><span class="co">##       &gt;&gt;&gt; 1: baseline</span></span>
<span><span class="co">##       &gt;&gt;&gt; 2: indegreeSender</span></span>
<span><span class="co">## &gt; Receiver model:</span></span>
<span><span class="co">##   &gt;&gt; Dimensions: 100 events x 5 actors x 2 statistics</span></span>
<span><span class="co">##   &gt;&gt; Statistics:</span></span>
<span><span class="co">##       &gt;&gt;&gt; 1: inertia</span></span>
<span><span class="co">##       &gt;&gt;&gt; 2: reciprocity</span></span></code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Finally, we are ready to run any of the optimization methods with
the function <code><a href="../reference/remstimate.html">remstimate::remstimate()</a></code>.</li>
</ol>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for example the method "MLE"</span></span>
<span><span class="fu">remstimate</span><span class="fu">::</span><span class="fu"><a href="../reference/remstimate.html">remstimate</a></span><span class="op">(</span>reh <span class="op">=</span> <span class="va">ao_reh</span>,</span>
<span>                          stats <span class="op">=</span>  <span class="va">ao_stats</span>,</span>
<span>                          method <span class="op">=</span> <span class="st">"MLE"</span>,</span>
<span>                          ncores <span class="op">=</span> <span class="va">ncores</span><span class="op">)</span>    </span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Model (actor oriented) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients rate model **for sender**:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       baseline indegreeSender </span></span>
<span><span class="co">##   -4.806201529   -0.008363321 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Null deviance: 1177.625 </span></span>
<span><span class="co">## Residual deviance: 1177.348 </span></span>
<span><span class="co">## AIC: 1181.348 AICC: 1181.472 BIC: 1186.558</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## --------------------------------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients choice model **for receiver**:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     inertia reciprocity </span></span>
<span><span class="co">## -0.03250837  0.01828748 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Null deviance: 2.772589 </span></span>
<span><span class="co">## Residual deviance: 277.0551 </span></span>
<span><span class="co">## AIC: 281.0551 AICC: 281.1789 BIC: 286.2655</span></span></code></pre>
<p>In the sections below, as already done with the tie-oriented
framework, we show the estimation of the parameters using all the
methods available and we also show the usage and output of the methods
available for a <code>remstimate</code> object.</p>
<hr>
</div>
</div>
<div class="section level4">
<h4 id="frequentist-approaches-1">
<em>Frequentist</em> approaches<a class="anchor" aria-label="anchor" href="#frequentist-approaches-1"></a>
</h4>
<div class="section level5">
<h5 id="maximum-likelihood-estimation-mle-1">
<strong>Maximum Likelihood Estimation (MLE)</strong><a class="anchor" aria-label="anchor" href="#maximum-likelihood-estimation-mle-1"></a>
</h5>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ao_mle</span> <span class="op">&lt;-</span> <span class="fu">remstimate</span><span class="fu">::</span><span class="fu"><a href="../reference/remstimate.html">remstimate</a></span><span class="op">(</span>reh <span class="op">=</span> <span class="va">ao_reh</span>,</span>
<span>                        stats <span class="op">=</span> <span class="va">ao_stats</span>,</span>
<span>                        ncores <span class="op">=</span> <span class="va">ncores</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"MLE"</span>,</span>
<span>                        WAIC <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># setting WAIC computation to TRUE</span></span>
<span>                        nsimWAIC <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># number of draws for the computation of the WAIC set to 100            </span></span></code></pre></div>
<div class="section level6">
<h6 id="print-1">
<strong>print( )</strong><a class="anchor" aria-label="anchor" href="#print-1"></a>
</h6>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># printing the 'remstimate' object </span></span>
<span><span class="va">ao_mle</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Model (actor oriented) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients rate model **for sender**:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       baseline indegreeSender </span></span>
<span><span class="co">##   -4.806201529   -0.008363321 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Null deviance: 1177.625 </span></span>
<span><span class="co">## Residual deviance: 1177.348 </span></span>
<span><span class="co">## AIC: 1181.348 AICC: 1181.472 BIC: 1186.558 WAIC: 1181.781 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## --------------------------------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients choice model **for receiver**:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     inertia reciprocity </span></span>
<span><span class="co">## -0.03250837  0.01828748 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Null deviance: 2.772589 </span></span>
<span><span class="co">## Residual deviance: 277.0551 </span></span>
<span><span class="co">## AIC: 281.0551 AICC: 281.1789 BIC: 286.2655 WAIC: 280.5819</span></span></code></pre>
</div>
</div>
<div class="section level5">
<h5 id="summary-1">
<strong>summary( )</strong><a class="anchor" aria-label="anchor" href="#summary-1"></a>
</h5>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># summary of the 'remstimate' object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ao_mle</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Model (actor oriented) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call rate model **for sender**:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  ~1 + remstats::indegreeSender()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients rate model (MLE with interval likelihood):</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                   Estimate    Std. Err     z value Pr(&gt;|z|) Pr(=0)</span></span>
<span><span class="co">## baseline        -4.8062015   0.1832563 -26.2266709      0.0 &lt;2e-16</span></span>
<span><span class="co">## indegreeSender  -0.0083633   0.0159467  -0.5244534      0.6 0.8971</span></span>
<span><span class="co">## Null deviance: 1177.625 on 100 degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 1177.348 on 98 degrees of freedom</span></span>
<span><span class="co">## Chi-square: 0.2770484 on 2 degrees of freedom, asymptotic p-value 0.8706422 </span></span>
<span><span class="co">## AIC: 1181.348 AICC: 1181.472 BIC: 1186.558 WAIC: 1181.781 </span></span>
<span><span class="co">## -------------------------------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call choice model **for receiver**:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  ~remstats::inertia() + remstats::reciprocity()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients choice model (MLE with interval likelihood):</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##              Estimate  Std. Err   z value Pr(&gt;|z|) Pr(=0)</span></span>
<span><span class="co">## inertia     -0.032508  0.077037 -0.421983   0.6730 0.9015</span></span>
<span><span class="co">## reciprocity  0.018287  0.071630  0.255305   0.7985 0.9064</span></span>
<span><span class="co">## Null deviance: 2.772589 on 100 degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 277.0551 on 98 degrees of freedom</span></span>
<span><span class="co">## Chi-square: -274.2826 on 2 degrees of freedom, asymptotic p-value 1 </span></span>
<span><span class="co">## AIC: 281.0551 AICC: 281.1789 BIC: 286.2655 WAIC: 280.5819</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="information-critieria-1">
<strong>Information Critieria</strong><a class="anchor" aria-label="anchor" href="#information-critieria-1"></a>
</h5>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># aic</span></span>
<span><span class="fu"><a href="../reference/aic.html">aic</a></span><span class="op">(</span><span class="va">ao_mle</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   sender model receiver model </span></span>
<span><span class="co">##      1181.3481       281.0551</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># aicc</span></span>
<span><span class="fu"><a href="../reference/aicc.html">aicc</a></span><span class="op">(</span><span class="va">ao_mle</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   sender model receiver model </span></span>
<span><span class="co">##      1181.4718       281.1789</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># bic </span></span>
<span><span class="fu"><a href="../reference/bic.html">bic</a></span><span class="op">(</span><span class="va">ao_mle</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   sender model receiver model </span></span>
<span><span class="co">##      1186.5584       286.2655</span></span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#waic </span></span>
<span><span class="fu"><a href="../reference/waic.html">waic</a></span><span class="op">(</span><span class="va">ao_mle</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   sender model receiver model </span></span>
<span><span class="co">##      1181.7813       280.5819</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="diagnostics-1">
<strong>diagnostics( )</strong><a class="anchor" aria-label="anchor" href="#diagnostics-1"></a>
</h5>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># diagnostics</span></span>
<span><span class="va">ao_mle_diagnostics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diagnostics.html">diagnostics</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ao_mle</span>, reh <span class="op">=</span> <span class="va">ao_reh</span>, stats <span class="op">=</span> <span class="va">ao_stats</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="plot-1">
<strong>plot( )</strong><a class="anchor" aria-label="anchor" href="#plot-1"></a>
</h5>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ao_mle</span>, reh  <span class="op">=</span> <span class="va">ao_reh</span>, diagnostics <span class="op">=</span> <span class="va">ao_mle_diagnostics</span><span class="op">)</span></span></code></pre></div>
<p><img src="remstimate_files/figure-html/unnamed-chunk-27-1.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-27-2.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-27-3.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-27-4.png" width="50%"></p>
<hr>
</div>
<div class="section level5">
<h5 id="adaptive-gradient-descent-optimization-gdadamax-1">
<strong>Adaptive Gradient Descent Optimization
(GDADAMAX)</strong><a class="anchor" aria-label="anchor" href="#adaptive-gradient-descent-optimization-gdadamax-1"></a>
</h5>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ao_gd</span> <span class="op">&lt;-</span> <span class="fu">remstimate</span><span class="fu">::</span><span class="fu"><a href="../reference/remstimate.html">remstimate</a></span><span class="op">(</span>reh <span class="op">=</span> <span class="va">ao_reh</span>,</span>
<span>                        stats <span class="op">=</span>  <span class="va">ao_stats</span>,</span>
<span>                        ncores <span class="op">=</span> <span class="va">ncores</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"GDADAMAX"</span>,</span>
<span>                        epochs <span class="op">=</span> <span class="fl">200L</span>, <span class="co"># number of iterations of the Gradient-Descent algorithm</span></span>
<span>                        WAIC <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># setting WAIC computation to TRUE</span></span>
<span>                        nsimWAIC <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># number of draws for the computation of the WAIC set to 100     </span></span>
<span><span class="co"># print </span></span>
<span><span class="va">ao_gd</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Model (actor oriented) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients rate model **for sender**:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       baseline indegreeSender </span></span>
<span><span class="co">##     -0.1688384     -0.1017067 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Null deviance: 1177.625 </span></span>
<span><span class="co">## Residual deviance: 10066.19 </span></span>
<span><span class="co">## AIC: 10070.19 AICC: 10070.32 BIC: 10075.4 WAIC: 10287.92 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## --------------------------------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients choice model **for receiver**:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     inertia reciprocity </span></span>
<span><span class="co">## -0.02370260  0.01567611 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Null deviance: 2.772589 </span></span>
<span><span class="co">## Residual deviance: 277.0683 </span></span>
<span><span class="co">## AIC: 281.0683 AICC: 281.192 BIC: 286.2787 WAIC: 280.3747</span></span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># diagnostics</span></span>
<span><span class="va">ao_gd_diagnostics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diagnostics.html">diagnostics</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ao_gd</span>, reh <span class="op">=</span> <span class="va">ao_reh</span>, stats <span class="op">=</span> <span class="va">ao_stats</span><span class="op">)</span></span>
<span><span class="co"># plot</span></span>
<span><span class="co"># plot(x = ao_gd, reh  = ao_reh, diagnostics = ao_gd_diagnostics) # uncomment to use the plot function</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level4">
<h4 id="bayesian-approaches-1">
<em>Bayesian</em> approaches<a class="anchor" aria-label="anchor" href="#bayesian-approaches-1"></a>
</h4>
<div class="section level5">
<h5 id="bayesian-sampling-importance-resampling-bsir-1">
<strong>Bayesian Sampling Importance Resampling (BSIR)</strong><a class="anchor" aria-label="anchor" href="#bayesian-sampling-importance-resampling-bsir-1"></a>
</h5>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mfasiolo/mvnfast/" class="external-link">mvnfast</a></span><span class="op">)</span> <span class="co"># loading package for fast simulation from a multivariate Student t distribution</span></span>
<span><span class="va">priormvt</span> <span class="op">&lt;-</span> <span class="fu">mvnfast</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/mvnfast/man/dmvt.html" class="external-link">dmvt</a></span> <span class="co"># defining which distribution we want to use from the 'mvnfast' package</span></span>
<span><span class="va">ao_bsir</span> <span class="op">&lt;-</span> <span class="fu">remstimate</span><span class="fu">::</span><span class="fu"><a href="../reference/remstimate.html">remstimate</a></span><span class="op">(</span>reh <span class="op">=</span> <span class="va">ao_reh</span>,</span>
<span>                        stats <span class="op">=</span>  <span class="va">ao_stats</span>,</span>
<span>                        ncores <span class="op">=</span> <span class="va">ncores</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"BSIR"</span>,</span>
<span>                        nsim <span class="op">=</span> <span class="fl">100L</span>, <span class="co"># 100 draws from the posterior distribution</span></span>
<span>                        prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sender_model <span class="op">=</span> <span class="va">priormvt</span>, receiver_model <span class="op">=</span> <span class="va">priormvt</span><span class="op">)</span>, <span class="co">#  defining prior here, prior parameters follow below</span></span>
<span>                        prior_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sender_model <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ao_stats</span><span class="op">$</span><span class="va">sender_stats</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="co"># prior mu value for sender_model</span></span>
<span>                                                            sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ao_stats</span><span class="op">$</span><span class="va">sender_stats</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fl">1.5</span>, <span class="co"># prior sigma value for sender_model</span></span>
<span>                                                            df <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,  <span class="co"># prior df value</span></span>
<span>                                        receiver_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ao_stats</span><span class="op">$</span><span class="va">receiver_stats</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="co"># prior mu value for receiver_model</span></span>
<span>                                                            sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ao_stats</span><span class="op">$</span><span class="va">receiver_stats</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fl">1.5</span>, <span class="co"># prior sigma value for receiver_model</span></span>
<span>                                                            df <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="co"># prior df value</span></span>
<span>                        log <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># requiring log density values from the prior,</span></span>
<span>                        seed <span class="op">=</span> <span class="fl">20929</span>, <span class="co"># set a seed only for reproducibility purposes</span></span>
<span>                        WAIC <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># setting WAIC computation to TRUE</span></span>
<span>                        nsimWAIC <span class="op">=</span> <span class="fl">100</span> <span class="co"># number of draws for the computation of the WAIC set to 100     </span></span>
<span>                        <span class="op">)</span></span>
<span></span>
<span><span class="co"># summary </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ao_bsir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Model (actor oriented) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call rate model **for sender**:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  ~1 + remstats::indegreeSender()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Posterior Modes rate model (BSIR with interval likelihood):</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 Post.Mode    Post.SD      Q2.5%       Q50%  Q97.5% Pr(=0|x)</span></span>
<span><span class="co">## baseline       -4.8018252  0.1759390 -5.0995898 -4.7823997 -4.4837   &lt;2e-16</span></span>
<span><span class="co">## indegreeSender -0.0080396  0.0161221 -0.0390818 -0.0071234  0.0230   0.8983</span></span>
<span><span class="co">## Log posterior: -588.6755 WAIC: 1181.684 </span></span>
<span><span class="co">## -------------------------------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call choice model **for receiver**:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  ~remstats::inertia() + remstats::reciprocity()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Posterior Modes choice model (BSIR with interval likelihood):</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##              Post.Mode    Post.SD      Q2.5%       Q50% Q97.5% Pr(=0|x)</span></span>
<span><span class="co">## inertia     -0.0126845  0.0811262 -0.1744974 -0.0077218 0.1423   0.9081</span></span>
<span><span class="co">## reciprocity  0.0198576  0.0751748 -0.1140912  0.0010799 0.1581   0.9062</span></span>
<span><span class="co">## Log posterior: -138.4584 WAIC: 282.0644</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># diagnostics</span></span>
<span><span class="va">ao_bsir_diagnostics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diagnostics.html">diagnostics</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ao_bsir</span>, reh <span class="op">=</span> <span class="va">ao_reh</span>, stats <span class="op">=</span> <span class="va">ao_stats</span><span class="op">)</span></span>
<span><span class="co"># plot (only for the receiver_model, by setting sender_model = NA)</span></span>
<span><span class="co"># plot(x = ao_bsir, reh  = ao_reh, diagnostics = ao_bsir_diagnostics, sender_model = NA) # uncomment to use the plot function</span></span></code></pre></div>
<hr>
</div>
<div class="section level5">
<h5 id="hamiltonian-monte-carlo-hmc-1">
<strong>Hamiltonian Monte Carlo (HMC)</strong><a class="anchor" aria-label="anchor" href="#hamiltonian-monte-carlo-hmc-1"></a>
</h5>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ao_hmc</span> <span class="op">&lt;-</span> <span class="fu">remstimate</span><span class="fu">::</span><span class="fu"><a href="../reference/remstimate.html">remstimate</a></span><span class="op">(</span>reh <span class="op">=</span> <span class="va">ao_reh</span>,</span>
<span>                        stats <span class="op">=</span>  <span class="va">ao_stats</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"HMC"</span>,</span>
<span>                        ncores <span class="op">=</span> <span class="va">ncores</span>,</span>
<span>                        nsim <span class="op">=</span> <span class="fl">300L</span>, <span class="co"># 300 draws to generate per each chain</span></span>
<span>                        nchains <span class="op">=</span> <span class="fl">4L</span>, <span class="co"># 4 chains (each one long 200 draws) to generate</span></span>
<span>                        burnin <span class="op">=</span> <span class="fl">300L</span>, <span class="co"># burnin length is 300</span></span>
<span>                        L <span class="op">=</span> <span class="fl">100L</span>, <span class="co"># number of leap-frog steps</span></span>
<span>                        epsilon <span class="op">=</span> <span class="fl">0.1</span><span class="op">/</span><span class="fl">100</span>, <span class="co"># size of a leap-frog step</span></span>
<span>                        thin <span class="op">=</span> <span class="fl">2L</span>, <span class="co"># thinning size (this will reduce the final length of each chain will be 150)</span></span>
<span>                        seed <span class="op">=</span> <span class="fl">23029</span>, <span class="co"># set a seed only for reproducibility purposes</span></span>
<span>                        WAIC <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># setting WAIC computation to TRUE</span></span>
<span>                        nsimWAIC <span class="op">=</span> <span class="fl">100</span> <span class="co"># number of draws for the computation of the WAIC set to 100     </span></span>
<span>                        <span class="op">)</span></span>
<span></span>
<span><span class="co"># summary </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ao_hmc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Relational Event Model (actor oriented) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call rate model **for sender**:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  ~1 + remstats::indegreeSender()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Posterior Modes rate model (HMC with interval likelihood):</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 Post.Mode    Post.SD      Q2.5%       Q50%  Q97.5% Pr(=0|x)</span></span>
<span><span class="co">## baseline       -4.6587527  0.1024161 -4.8466379 -4.6503193 -4.4549   &lt;2e-16</span></span>
<span><span class="co">## indegreeSender -0.0192776  0.0090939 -0.0372322 -0.0195099 -0.0029   0.5139</span></span>
<span><span class="co">## Log posterior: -599.8593 WAIC: 1179.536 </span></span>
<span><span class="co">## -------------------------------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call choice model **for receiver**:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  ~remstats::inertia() + remstats::reciprocity()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Posterior Modes choice model (HMC with interval likelihood):</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##              Post.Mode    Post.SD      Q2.5%       Q50% Q97.5% Pr(=0|x)</span></span>
<span><span class="co">## inertia     -0.0328733  0.0440346 -0.1198729 -0.0259082 0.0533   0.8833</span></span>
<span><span class="co">## reciprocity  0.0189472  0.0410635 -0.0669650  0.0092633 0.0905   0.8999</span></span>
<span><span class="co">## Log posterior: -138.5283 WAIC: 278.4279</span></span></code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># diagnostics</span></span>
<span><span class="va">ao_hmc_diagnostics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diagnostics.html">diagnostics</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ao_hmc</span>, reh <span class="op">=</span> <span class="va">ao_reh</span>, stats <span class="op">=</span> <span class="va">ao_stats</span><span class="op">)</span></span>
<span><span class="co"># plot (only for the receiver_model, by setting sender_model = NA)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ao_hmc</span>, reh  <span class="op">=</span> <span class="va">ao_reh</span>, diagnostics <span class="op">=</span> <span class="va">ao_hmc_diagnostics</span>, sender_model <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="remstimate_files/figure-html/unnamed-chunk-33-1.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-33-2.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-33-3.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-33-4.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-33-5.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-33-6.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-33-7.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-33-8.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-33-9.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-33-10.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-33-11.png" width="50%"><img src="remstimate_files/figure-html/unnamed-chunk-33-12.png" width="50%"></p>
<hr>
</div>
<div class="section level5">
<h5 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h5>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Butts2008" class="csl-entry">
Butts, Carter T. 2008. <span>“4. A Relational Event Framework for Social
Action.”</span> <em>Sociological Methodology</em> 38 (1): 155–200. <a href="https://doi.org/10.1111/j.1467-9531.2008.00203.x" class="external-link">https://doi.org/10.1111/j.1467-9531.2008.00203.x</a>.
</div>
<div id="ref-Cox1972" class="csl-entry">
Cox, D. R. 1972. <span>“Regression Models and Life-Tables.”</span>
<em>Journal of the Royal Statistical Society. Series B
(Methodological)</em> 34 (2): 187–220. <a href="http://www.jstor.org/stable/2985181" class="external-link">http://www.jstor.org/stable/2985181</a>.
</div>
<div id="ref-Stadtfeld2017" class="csl-entry">
Stadtfeld, Christoph, and Per Block. 2017. <span>“Interactions, Actors,
and Time: Dynamic Network Actor Models for Relational Events.”</span>
<em>Sociological Science</em> 4 (14): 318–52. <a href="https://doi.org/10.15195/v4.a14" class="external-link">https://doi.org/10.15195/v4.a14</a>.
</div>
</div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giuseppe Arena, Rumana Lakdawala, Fabio Generoso Vieira.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
